(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(5155),l=s(2115),r=s(63),n=s(8490);function i(){let e=(0,r.useRouter)(),t=(0,n.createBrowserClient)("https://idkwiphboefqdefwcvrl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlka3dpcGhib2VmcWRlZndjdnJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1NDg0NTUsImV4cCI6MjA4MDEyNDQ1NX0.xdNW-gFw2m2vAy0jhCrYHItbZenP9p4sZSwt99S9fuw"),[s,i]=(0,l.useState)(!0),[c,d]=(0,l.useState)([]),[o,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(""),[x,g]=(0,l.useState)(""),[p,b]=(0,l.useState)(null),[f,j]=(0,l.useState)(""),[N,w]=(0,l.useState)(""),[v,y]=(0,l.useState)(""),[C,S]=(0,l.useState)(null),[I,_]=(0,l.useState)(0),[k,P]=(0,l.useState)(!0);async function D(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];u(!0),g("");let s=e?0:I,a=20*s;try{let{data:l,error:r}=await t.from("posts").select("*").order("created_at",{ascending:!1}).range(a,a+20-1);if(r)throw r;e?(d(l||[]),_(1)):(d(e=>[...e,...l||[]]),_(s+1)),P(l&&20===l.length)}catch(e){g("Failed to load posts")}finally{u(!1)}}async function E(e){if(e.preventDefault(),g(""),h(""),!f.trim()||!N.trim())return void g("Title and content are required.");let s=f.toString().normalize("NFKD").replace(/[\u2013\u2014]/g,"-").replace(/&/g," and ").replace(/[^a-zA-Z0-9\s-]/g,"").trim().toLowerCase().replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");try{let e={title:f.trim(),slug:s,content_html:N,image_url:v||null};if(p){let{error:s}=await t.from("posts").update(e).eq("id",p.id);if(s)throw s;h("Post updated.")}else{let{error:s}=await t.from("posts").insert([e]);if(s)throw s;h("Post created.")}L(),D(!0)}catch(e){g(e.message||"Save failed")}}function L(){b(null),j(""),w(""),y("")}async function J(e){if(confirm("Delete this post?"))try{let{error:s}=await t.from("posts").delete().eq("id",e);if(s)throw s;h("Post deleted."),D(!0)}catch(e){g("Delete failed")}}return(0,l.useEffect)(()=>{!async function(){let{data:s}=await t.auth.getUser();s.user?i(!1):e.push("/login")}()},[e,t]),(0,l.useEffect)(()=>{s||D(!0)},[s]),(0,l.useEffect)(()=>{if(!k||o)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&D()}),t=document.getElementById("scroll-sentinel");return t&&e.observe(t),()=>e.disconnect()},[k,o]),s?(0,a.jsx)("p",{className:"text-center p-8",children:"Checking authentication..."}):(0,a.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:p?"Edit Post":"Create New Post"}),(0,a.jsx)("button",{onClick:async()=>{await t.auth.signOut(),e.push("/login")},className:"px-3 py-2 bg-red-600 text-white rounded",children:"Logout"})]}),m&&(0,a.jsx)("div",{className:"mb-4 text-green-700 bg-green-50 p-2 rounded",children:m}),x&&(0,a.jsx)("div",{className:"mb-4 text-red-700 bg-red-50 p-2 rounded",children:x}),(0,a.jsxs)("form",{onSubmit:E,className:"mb-8 bg-white p-5 rounded shadow",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block mb-1 font-semibold",children:"Title"}),(0,a.jsx)("input",{value:f,onChange:e=>j(e.target.value),className:"w-full border p-2 rounded",required:!0})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block mb-1 font-semibold",children:"Image URL"}),(0,a.jsx)("input",{value:v,onChange:e=>y(e.target.value),className:"w-full border p-2 rounded"})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block mb-1 font-semibold",children:"Content (HTML)"}),(0,a.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),rows:12,className:"w-full border p-2 rounded font-mono",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:p?"Update":"Create"}),p&&(0,a.jsx)("button",{type:"button",onClick:L,className:"px-3 py-2 bg-gray-300 rounded",children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"px-3 py-2 bg-gray-100 rounded",onClick:()=>S({id:"",title:f,slug:"",content_html:N,image_url:v,created_at:new Date().toISOString()}),children:"Live preview"})]})]}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"All Posts"}),c.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4 p-4 border rounded bg-white mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.image_url?(0,a.jsx)("img",{src:e.image_url,className:"w-20 h-12 object-cover rounded"}):(0,a.jsx)("div",{className:"w-20 h-12 bg-gray-200 rounded flex items-center justify-center text-xs text-gray-500",children:"No image"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.slug})]})]}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Created: ",new Date(e.created_at).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{b(e),j(e.title),w(e.content_html),y(e.image_url||""),window.scrollTo({top:0,behavior:"smooth"})},className:"px-3 py-1 bg-yellow-500 text-white rounded",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>J(e.id),className:"px-3 py-1 bg-red-600 text-white rounded",children:"Delete"}),(0,a.jsx)("button",{onClick:()=>S(e),className:"px-3 py-1 bg-blue-600 text-white rounded",children:"View"})]})]},e.id)),(0,a.jsx)("div",{id:"scroll-sentinel",className:"h-10"}),o&&(0,a.jsx)("p",{className:"text-center py-4 text-gray-500",children:"Loadingâ€¦"}),!k&&(0,a.jsx)("p",{className:"text-center py-4 text-gray-400",children:"You reached the end \uD83C\uDF89"}),C&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-start justify-center p-6 z-50",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-auto max-h-[90vh] mt-12",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h3",{className:"font-semibold",children:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(C.title)}),(0,a.jsx)("button",{onClick:()=>S(null),className:"px-3 py-1 bg-gray-300 rounded",children:"Close"})]}),(0,a.jsxs)("div",{className:"p-4",children:[C.image_url&&(0,a.jsx)("img",{src:C.image_url,className:"w-full h-56 object-cover rounded mb-4"}),(0,a.jsx)("div",{className:"prose",dangerouslySetInnerHTML:{__html:C.content_html}})]})]})})]})}},8548:(e,t,s)=>{Promise.resolve().then(s.bind(s,5782))}},e=>{e.O(0,[490,441,255,358],()=>e(e.s=8548)),_N_E=e.O()}]);